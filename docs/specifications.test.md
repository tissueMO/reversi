# リバーシゲーム テスト仕様書

## テスト設計方針

- 仕様書に記載された各機能・画面・ルールが外部から観測可能な形で正しく動作することを検証する。
- 単体テスト、結合テスト、総合テストの観点で網羅的にテストケースを設計する。
- テストケースごとにタイトル、テスト観点、テスト手順、期待する結果を明記する。

---

## 単体テスト

### ゲームルール

- タイトル: 石の配置ルールの検証

  - 観点: ひっくり返せる場所にのみ石が置けること
  - 手順: 任意の局面で無効なマスをクリック
  - 期待: 石が置かれない

- タイトル: ターン交代の検証

  - 観点: 石を置くと手番が交代すること
  - 手順: 有効なマスに石を置く
  - 期待: 手番が相手に切り替わる

- タイトル: 石のひっくり返し処理
  - 観点: 挟まれた石が正しく反転すること
  - 手順: ひっくり返せる局面で石を置く
  - 期待: 挟まれた石がすべて自分の色に変わる

### CPU 戦略

- タイトル: 初級 CPU の手選択

  - 観点: 有効な手からランダムに選択されること
  - 手順: CPU 初級で複数手がある局面を作る
  - 期待: いずれかの有効手が選ばれる

- タイトル: 最強 CPU のフォールバック
  - 観点: モデル読み込み失敗時に上級戦略へ自動切替
  - 手順: モデルファイルを削除し最強 CPU で対局
  - 期待: 上級 CPU の手が選ばれる

### CPU 各強さの特徴的な一手の単体テスト

- タイトル: 初級 CPU の特徴的な手選択の検証

  - 観点: 有効な手からランダムに選択されること
  - 手順: 複数の有効手が存在する局面で初級 CPU に手を選ばせる
  - 期待: いずれかの有効手が選ばれる（特定の手に偏らない）

- タイトル: 中級 CPU の角優先戦略の検証

  - 観点: 角が有効手に含まれる場合は角を優先して選択すること
  - 手順: 角とそれ以外の有効手が存在する局面で中級 CPU に手を選ばせる
  - 期待: 角のマスが選ばれる

- タイトル: 上級 CPU の石数最大化戦略の検証

  - 観点: 終盤で石数が最大化される手を選択すること
  - 手順: 終盤で複数の有効手があり、石数最大化できる手が存在する局面で上級 CPU に手を選ばせる
  - 期待: 石数が最大化される手が選ばれる

- タイトル: 最強 CPU の AI 推論・フォールバックの検証
  - 観点: モデル読み込み成功時は AI 推論、失敗時は上級戦略にフォールバックすること
  - 手順: モデル読み込み成功時・失敗時それぞれで最強 CPU に手を選ばせる
  - 期待: 成功時は AI 推論の結果、失敗時は上級 CPU の戦略に従った手が選ばれる

---

## 結合テスト

### ゲーム進行

- タイトル: 石が置けない場合のスキップ

  - 観点: 有効手がない場合に自動で相手ターンになる
  - 手順: 片方がパスになる局面を作る
  - 期待: 手番が自動で相手に移る

- タイトル: ゲーム終了判定
  - 観点: 両者とも手がない場合にゲームが終了する
  - 手順: 終局直前まで進める
  - 期待: 結果モーダルが表示される

### UI 表示

- タイトル: 石数・手番表示

  - 観点: 画面上の石数・手番表示が正しい
  - 手順: 任意の局面で石数・手番を確認
  - 期待: 実際の盤面と一致する

- タイトル: 勝敗結果表示
  - 観点: 勝敗・石数・アイコン・クラッカー演出の表示
  - 手順: 勝敗が決まる局面まで進める
  - 期待: 結果モーダルに正しい情報が表示される

---

## 総合テスト

### 各種対戦モード

- タイトル: プレイヤー対 CPU 対戦

  - 観点: 設定モーダルで選択し正常に対局できる
  - 手順: 設定モーダルでプレイヤー対 CPU を選択しゲーム開始
  - 期待: プレイヤーと CPU が交互に手を打つ

- タイトル: CPU 対 CPU 対戦
  - 観点: 黒・白の強さを個別設定し自動対局できる
  - 手順: 設定モーダルで CPU 対 CPU を選択し両方の強さを設定して開始
  - 期待: 両 CPU が自動で手を打ちゲームが進行する

### デバッグ機能

- タイトル: skipToEndGame() の動作

  - 観点: 終了 2 手前まで進める
  - 手順: デバッグコンソールで skipToEndGame() を実行
  - 期待: 盤面が終局 2 手前の状態になる

- タイトル: forceGameEnd() の動作

  - 観点: 強制的にゲーム終了状態になる
  - 手順: デバッグコンソールで forceGameEnd() を実行
  - 期待: 結果モーダルが表示される

- タイトル: setPlayer() の動作
  - 観点: 手番プレイヤーが指定通りに切り替わる
  - 手順: デバッグコンソールで setPlayer(1) または setPlayer(2) を実行
  - 期待: 手番表示が指定したプレイヤーになる

---

## 非機能テスト

- タイトル: レスポンシブ表示

  - 観点: モバイル・PC で UI が最適化される
  - 手順: 画面サイズを変更
  - 期待: UI が崩れず最適化される

- タイトル: TensorFlow.js モデルのウォームアップ

  - 観点: 初回アクセス時にモデルが正常にロードされる
  - 手順: 最強 CPU で初回対局を開始
  - 期待: モデルが正常にロードされ、CPU が手を選択する

- タイトル: パフォーマンス
  - 観点: AI 思考・UI 描画が遅延なく動作する
  - 手順: CPU 対 CPU で連続対局
  - 期待: 目立った遅延やフリーズが発生しない
